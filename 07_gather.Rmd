---
title: "Gathering main findings, tables and figures  for TNC-NTRI rangeland management project publication"
author: |
  | Stefan Gehrig
  | www.estimact.com / estimact@onmail.com
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  bookdown::pdf_document2:
    extra_dependencies: ["float"]
    fig_caption: yes
    latex_engine: xelatex
    number_sections: yes
    toc: no
header-includes:
  \usepackage[colorlinks]{hyperref}
  \AtBeginDocument{
  \hypersetup{
    linkcolor=Blue}}
  \pagenumbering{gobble}
  \usepackage{fontspec}
  \usepackage{float}
  \floatplacement{figure}{H}
  \usepackage{natbib}
  \setmainfont{Segoe UI Light}
  \usepackage{xfrac}
  \usepackage{bm}
  \usepackage{amsmath}
  \usepackage[left]{lineno}
  \usepackage{pdflscape}
  \usepackage[labelfont=bf]{caption}
  \newcommand{\blandscape}{\begin{landscape}}
  \newcommand{\elandscape}{\end{landscape}}
  \setlength{\tabcolsep}{4pt}
  \usepackage{titling}
  \pretitle{\begin{center}
  \vspace{-2.5cm}
  \includegraphics[height=1.25cm]{utils/estimact.png}
    \vspace{0.85cm}\LARGE\\}
  \posttitle{\end{center}}
  \usepackage{setspace}
  \singlespacing
  \usepackage{fancyhdr}
  \usepackage{fancybox}
  \pagestyle{fancy}
  \fancyhead{}
fontsize: 10pt
bibliography: utils/refs.bib
urlcolor: blue
geometry: top=1in, bottom=1in, left=1in, right=1in
---

\fancyhead[C]{www.estimact.com / estimact@onmail.com}

\vspace{0.5cm}

*Data:* https://stefgehrig.shinyapps.io/TNC-NTRI/   
*Code:* https://github.com/stefgehrig/rangeland 

\vspace{0.25cm}

In line with the comments received and discussions had (e-mail from Monique, 2023-08-05), here we are starting to collect and results, tables and figures which could make it into the main text or supplemental material (SM) of the manuscript that Monique et al. will be preparing. The previous delivery of results (my e-mail from 2023-07-24) contained a more diverse set of explorations and presentations, but at this stage, we are ready to zoom in again on the relevant paths of analysis to be pursued and a reduced set of ways to present the results. This helps to gain structure and reduce confusion.

\vspace{0.25cm}

```{=latex}
\tableofcontents
```
 
\newpage \pagenumbering{arabic} \setcounter{page}{1}
 
```{r setup, include=FALSE}
library(knitr)
library(kableExtra)
library(tidyverse)
library(brms)
library(dagitty)
library(ggdag)
knitr::opts_chunk$set(echo = FALSE)

gat_tab1     <- readRDS("outputs/gat_tab1.rds")
gat_tab2     <- readRDS("outputs/gat_tab2.rds")
pars_tab     <- readRDS("outputs/pars_tab.rds")
pars_tab2    <- readRDS("outputs/fit_bare_parstab.rds")
fit_irt_2par <- readRDS(file = "outputs/fit_irt_2par.rds")
```


\textcolor{red}{schau nochmal in den NTRI (!) report, das Word doc. Da sind viele wertvolle richtungen zu denken drin mit dem ganzen substantivem wissen Ã¼ber den Ort und so und den Fragen die sie analysieren.}

# Descriptive tables and figures

It would make sense to split the data we use in two "types" and also present them in that way, to be very clear to readers. The first type are those Diagnostic Framework (DF) variables that are constructed from interviews and focus groups and coded in binary / ordinal manner (and used as outcome or predictor). These are noisy measurements of underlying latent traits and that is also the way we treat them in the analysis. One way to present them (main text or SM) is for example Table \ref{tab:dfsum}. The variables are based on the DF in the version from @mcginnis_social-ecological_2014 and measured in line with definitions from the Social-ecological systems meta-analysis database
(SESMAD) project [@cox_concepts_2020]. I'd suggest to only present the DF variables which actually use for the analysis, which is the logic I followed here.^[Of course, a full list of DF variables collected during the project could still go in the SM. But there are some variables that we cannot make good use of for the current analysis and they would maybe distract.] This reduction of DF variables from the full set to a reduced set could become a methodological side-story of the manuscript: The full DF is a very mixed bag and not per se a suitable tool for impact assessments or analyzing pathways of change -- but it a quite massively filled bag from which one can draw subsets for more targeted research questions. That would point to the recommendation that scholars use the tool to develop their own causal hypotheses and select own subsets of variables (e.g., those believed to be most accurate and/or showing most variation).

```{r dfsum}
dfsum <- gat_tab1 %>% 
  mutate(bin = ifelse(bin==TRUE, "*", " "),
         tier1 = droplevels(tier1)) 

dfsum %>% 
  select(-tier1) %>% 
  kable(
    booktabs = TRUE,
     linesep = "",
    caption = "Third-tier DF variables and their response distributions in the 12 villages, grouped by first-tier variables. Only DF variables used in the analysis are shown. The asterik indicates whether a variable has originally been coded as binary and was therefore transformed to only have response options 1 and 3 (i.e., no middle option).",
    col.names = c("Third-tier variable", "1", "2", "3", " ", "Explanation of highest score"),
    ) %>% 
  kable_styling(font_size = 5.5, latex_options = "HOLD_position") %>% 
  add_header_above(c(" " = 1, "Score\nfrequency" = 3, " " = 2)) %>% 
  kableExtra::group_rows(index = table(dfsum$tier1))
```


Then, there is the second type of data we use in the current analysis, which is *everything measured on a continuous scale* (and used as outcome or predictor). These data cannot be easily pooled with the data from Table \ref{tab:dfsum}, because they live on a different scale. The different ways to bring them on comparable scales for presentations (see previous reports) are not really ideal. Some of these other variables might correspondent to a DF dimension, but we separate them conceptually from the variables in Table \ref{tab:dfsum} due to the way they are measured and due to the role they play in the analysis (that will become clearer in the sections below). They are summarized in Table \ref{tab:othersum}.^[For economic inequality, we estimate the within-village SD from the first PC of a PCA on household assets based on the household survey [following @sharma_escalation_2023]. These assets include the availability/quality of wall, floor, roof, toilet, mobile phone, motorcycle and bed. As quick check of validity, the resuling score strongly correlates with the proportion of people in a village having a motorcycle ($r \approx 0.7$), which in this local context could be a simple indicator of wealth inequality.]

```{r othersum}
gat_tab2 %>% 
  kable(
    booktabs = TRUE,
    digits = 2,
     linesep = "",
    caption = "Other, continuously measured variables used in the analysis and their response distributions in the 12 villages.",
    col.names = c("Variable", "Mean", "Min", "Max", "Source"),
    ) %>% 
  kable_styling(font_size = 8, latex_options = "HOLD_position")%>% 
  add_header_above(c(" " = 1, "Distribution" = 3, " " = 1)) 
```


A natural way to visualize for all villages the data in Table \ref{tab:dfsum} is via spider plots (Figure \ref{fig:radar}), for Table \ref{tab:othersum} it is via raincloud plots (Figure \ref{fig:boxes}). These plots allow to once more sanity check the values of the DF variables and of the remote-sensing-based variables that go into my analysis, for example by comparing them to the values in other data files or by checking if they are plausible (would need to be done by someone who knows the villages better than I do). In Figure \ref{fig:radar}, DF variables are already separated into whether they fall under governance processes (all DF variables in Table \ref{tab:dfsum} from the first-tier categories *Resource Systems (RS)*, *Governance Systems (GS)*, *Actors (A)* and *Interactions (I)*) or governance outcomes (all DF variables in Table \ref{tab:dfsum} from the first-tier category *Outcomes (O)*) -- a distinction motivated in a later section and relevant for the main analysis.

\newpage

```{r radar, fig.align='center', fig.cap='Village-level spider plots of scores for all DF variables from Table 1, split by whether they refer to outcome governance outcomes (right) or governance processes (left).', out.width="100%"}
include_graphics("outputs/gat_spiders.png")
```

\newpage

```{r boxes, fig.align='center', fig.cap='Raincloud plots for variables from Table 2. Upper panels (a) and (b) have log-scaled y axes for readability.', out.width="100%"}
include_graphics("outputs/gat_rainclouds.png")
```

\newpage

Figure \ref{fig:map1} shows a map of the assessment villages and the associated areas used in remote sensing analysis to calculate the values shown in Table \ref{tab:othersum} and Figure \ref{fig:boxes}.^[Village boundaries used in analysis and shown here exclude any National Park areas.]

```{r map1, fig.align='center', fig.cap='Map of Northern Tanzania showing the assessment villages with their associated grazing land areas used for analysis.', out.width="75%"}
include_graphics("outputs/map_terr_vills.png")
```

\newpage

# Item response modeling: Relation between self-reported governance processes and outcomes

This whole section is more or less completely drafted and open to discussion (e.g., what to add/leave out).

## Motivation

We now model the association between governance processes and governance outcomes as reported by communities. This is based on the data presented in Table \ref{tab:dfsum}. The workhorse of the analysis will be a Bayesian Item Response Model fit with `brms` [@burkner_bayesian_2021; @fox_bayesian_2010]. 

Item Response Theory (IRT) is a statistical modeling paradigm from psychology that aims to simultaneously assess respondent-level and item-level influences on test scores [@linden_handbook_1997]. It can be viewed as a form of statistical adjustment for item characteristics that allows inference about unobserved latent characteristics of respondents. In our research context, the "respondents" are communities and the items are coded responses from in-depth focus group discussions and interviews. Therefore, in the context of this analysis, we also refer to the third-tier DF variables in Table \ref{tab:dfsum} as items.

Based on the nature of our items, we a priori propose two underlying latent traits of communities: The quality of the governance process and the quality of the governance outcome. We briefly call the two dimensions *Governance* and *Outcome*. The former is measured by the type of items that refer to governance processes -- all third-tier variables in Table \ref{tab:dfsum} listed under the first-tier categories *Resource Systems (RS)*, *Governance Systems (GS)*, *Actors (A)* and *Interactions (I)*. The latter is measured by the type of items that measure governance outcomes -- listed in Table \ref{tab:dfsum} under the first-tier category *Outcomes (O)*.^[Even though the DF does not put all of these variables into the *Governance Systems (GS)* category, they arguably reflect commons governance processes.] This distinction between these two item types is made on conceptual grounds and in line with the goal to assess the association between governance processes and governance outcomes.

Variation in item responses between villages is assumed to partially reflect true variation in the underlying latent traits of villages, but also measurement error. At the same time, the IRT models will allow to model variation in responses between items due to item *easiness* (the characteristic of an item to produce higher responses by villages) and item *discrimination* (the characteristic of an item to produce responses that allow to distinguish better between villages of different governance process or outcome quality). Such variation is clearly suggested already by the raw data (see Table \ref{tab:dfsum}). Thus, IRT can provide a comprehensive picture of different sources of variation in item responses. Most importantly for our purpose, the model will allow to estimate the positioning of all villages on the two latent dimensions *Governance* and *Outcome*, as well as the correlation across dimensions.

Fitting the IRT model in a Bayesian framework provides a natural way to induce regularization via prior distributions and to quantify and present uncertainty. Due to the rather small sample of villages and the inherent tendency of IRT models to have a high number of parameters to be estimated from data, these aspects are both important in the present analysis. Bayesian IRT models have been used before to infer latent traits of natural resource users [e.g., @pretelli_rates_2022]. 

## Formal model definition

Response of village $j = 1,...,J$ on item $i = 1, ..., I$ shall be denoted as $Y_{i,j}$. Since these scores can take discrete values $k = 1,2,3$, we assume a multinomial distribution of item responses 

$$Y_{i,j} \sim \text{Multinomial}(\pi_{1, i, j}, \pi_{2, i, j}, \pi_{3, i, j}),$$

where $\pi_{k, i, j}$ denotes the probability of village $j$ to choose response $k$ on item $i$. Note that $\pi_{1, i, j} + \pi_{2, i, j}+ \pi_{3, i, j} = 1$ for all $i,j$.

Given the ordinal nature of the items responses, we use the cumulative logit link with common slopes, also known as proportional odds model.^[In IRT terminology, such models are known as "Graded Response Models" [@linden_handbook_1997, chapter 5].] Accordingly, the probability to give response $k$ or less can can be written as a function of a category-specific threshold parameter $\beta_k$ and a linear combination of village- and item-level characteristics $\eta_{i,j}$, which will ultimately be of substantive interest to us. Higher values of $\eta_{i,j}$ mean a higher expected response category. Further, an item-specific discrimination parameter $a_i$ is introduced. This leads to

$$
P(Y_{i,j} \leq k) = \text{logit}^{-1} \left(\text{exp}(\alpha + a_i) ( \beta_k - \eta_{i,j} ) \right), 
$$

where $\alpha$ is an intercept parameter for item discrimination, such that the $a_i$ represent deviations from mean discrimination for each item. Via including $a_i$, we allow that items do not have constant discrimination, i.e., that they may differ in how strongly changes in the latent trait of villages (a component of $\eta_{i,j}$, see below) affect response probabilities for that item. Unequal discrimination is a sensible assumption in the present setting particularly some of the items were originally scored on a dichotomous, others on a polytomous scale. In IRT terminology, the assumption of non-constant discrimination leads to the so-called "two-parameter model" [@linden_handbook_1997], since an additional item-level parameter besides item easiness (see below) is introduced.^[Due to the multiplicativeness of this relationship, the two-parameter model is no more linear in the parameters.] By exponentiating $(\alpha + a_i)$, discrimination is always positive. Put differently, discrimination is modeled on the log-scale, which is the default implementation in `brms` [@burkner_bayesian_2021].

The probabilities to give responses $k = 1,2,3$ can hence be written as

\begin{align*}
\pi_{1, i, j} & = P(Y_{i,j} = 1) = \text{logit}^{-1}\left(\text{exp}(\alpha + a_i) ( \beta_1 - \eta_{i,j} ) \right), \\
\pi_{2, i, j} & = P(Y_{i,j} = 2) = \text{logit}^{-1}\left(\text{exp}(\alpha + a_i) ( \beta_2 - \eta_{i,j} ) \right) - \pi_{1, i, j}, \\
\pi_{3, i, j} & = P(Y_{i,j} = 3) = 1 - \pi_{2, i, j} - \pi_{1, i, j},
\end{align*}

with $\beta_1 < \beta_2$. No parameter $\beta_3$ is needed, since $\pi_{3, i, j}$ is uniquely defined by the response probabilities of the other two categories.

Most importantly, $\eta_{i,j}$ shall be affected by $\theta_j^{\text{Gov}}$ and $\theta_j^{\text{Out}}$. These parameters describe the quality of governance processes and of outcomes in village $j$, respectively. Note that here we are ultimately interested in their correlation parameter $\rho_{\text{Gov},\text{Out}}$. In line with the IRT framework, we will model $\eta_{i,j}$ also as a function of easiness of the item, $b_i$. Accordingly, we write


$$\eta_{i,j} = b_i + \theta_j^{\text{Gov}} \text{Gov}_i + \theta_j^{\text{Out}} \text{Out}_i ,$$
where $\text{Gov}_i$ is an indicator that is 1 if item $i$ is of type *Governance* and 0 otherwise. $\text{Out}_i$ is an indicator that is 1 if item $i$ is of type *Outcome* and 0 otherwise.

Finally, working in a Bayesian framework with varying parameters, we assume that item- and village-level parameters follow the distributions

\begin{align*}
(a_i, b_i)^{t} & \sim \text{Normal}(\bm{0}, D_1), \text{with} \\ 
& D_1 =
\begin{pmatrix}
\sigma^2_{a} & \sigma_{a,b}\\
\sigma_{a,b} & \sigma^2_{b}
\end{pmatrix}, \\ \\
(\theta_j^{\text{Gov}}, \theta_j^{\text{Out}})^{t} & \sim \text{Normal}(\bm{0}, D_2), \text{with} \\ 
& D_2 =
\begin{pmatrix}
\sigma^2_{\text{Gov}} & \sigma_{\text{Gov},\text{Out}}\\
\sigma_{\text{Gov},\text{Out}} & \sigma^2_{\text{Out}}
\end{pmatrix}.
\end{align*}

This implies that the two item parameters $a_i$ and $b_i$ are allowed to covary. Accounting for within-item dependencies in this way is usually desirable in IRT modeling [@fox_bayesian_2010, p. 36-37]. Likewise, the two village-parameters $\theta_j^{\text{Gov}}$ and $\theta_j^{\text{Out}}$, follow a bivariate normal distribution with covariance $\sigma_{\text{Gov},\text{Out}}$. We can hence define our parameter of interest, the correlation between governance and outcome quality, based on the IRT model as 

$$\rho_{\text{Gov},\text{Out}} = \frac{\sigma_{\text{Gov},\text{Out}}}{\sigma_{\text{Gov}} \sigma_{\text{Out}}}.$$


By choosing hierarchical priors that induce some shrinkage to the empirical mean, above IRT model becomes a Bayesian hierarchical model. Such pooling of information can lead to improved estimation of respondent and item parameters in IRT models [@fox_bayesian_2010; @burkner_bayesian_2021]. Specifically, we work with the following priors:

\begin{align*}
\alpha & \sim \text{Normal}(0,1), \\
\sigma_a & \sim \text{Exponential}(1.5), \\
\sigma_b & \sim \text{Exponential}(1.5), \\
\begin{pmatrix} 1 & \rho_{a,b} \\ \rho_{a,b} & 1 \end{pmatrix} & \sim \text{LKJCorr}(1), \\
\begin{pmatrix} 1 & \rho_{\text{Gov},\text{Out}} \\ \rho_{\text{Gov},\text{Out}} & 1 \end{pmatrix} & \sim \text{LKJCorr}(1), \\
\beta_1 & \sim \text{Normal}(0, 2.5), \\
\beta_2 & \sim \text{Normal}(0, 2.5). \\
\end{align*}

In addition, the variances of the latent village characteristics are assumed as $\sigma^2_{\text{Gov}} = \sigma^2_{\text{Out}} = 1$, which we can interpret as a prior with all mass in one point. This is a common restriction in IRT to ensure identifiability of the model. These priors simply fix the metric of the latent village characteristics to a standard normal distribution [@fox_bayesian_2010, p. 88; @burkner_bayesian_2021].

In summary, our priors are chosen to have some regularizing influence on the parameters, ensuring model convergence and stability of estimates against the background of relatively sparse data, the occurrence of items with little to no variability between villages (see Table \ref{tab:dfsum}), and a rather richly parametrized model. For example, above exponential priors on the SD of both item parameters put most prior probability ($\approx$ `r round(pexp(1, 1.5), 2)`) on the SD being $\leq 1$ on the logit scale, but also allows for larger values.

## Results

We obtained `r summary(fit_irt_2par)$chains * (summary(fit_irt_2par)$iter - summary(fit_irt_2par)$warmup)` posterior draws sampled from `r summary(fit_irt_2par)$chains` chains, after `r summary(fit_irt_2par)$warmup` warm-up iterations per chain. Model convergence was acceptable -- judged by inspecting trace plots and R hat statistics -- and posterior predictive checks in Figure \ref{fig:ppds} indicate a good model fit to the data. It is also visible that the model-based distributions in general tend to be a bit less extreme than their empirical counterparts, which is at least partially a consequence of shrinkage^[@fox_bayesian_2010[p. 36] explicitly mentions this as an advantage of Bayesian IRT modeling: "An extreme and infinite item parameter estimate caused by the fact that the item is answered correctly or incorrectly by all respondents is avoided due to shrinkage towards the mean of the prior."], but follows also from some restrictions imposed by the proportional odds model.

```{r ppds, fig.align='center', fig.cap='Posterior predictions vs. observed response distributions (a) by item and (b) by village. In light blue empirical responses, in dark blue posterior predictions (median and 90\\% equal-tailed credible interval).', out.width="100%"}
include_graphics("outputs/ppcs_fit_irt_2par.png")
```

Figure \ref{fig:riestims} shows posteriors for all item- and village-level characteristics.

```{r riestims, fig.align='center', fig.cap='Village and item parameter posterior distributions (posterior median and equal-tailed 50\\% and 90\\% credible intervals).', out.width="100%"}
include_graphics("outputs/param_posts_fit_irt_2par.png")
```

Of primary interest is the correlation of the two latent village characteristics governance process quality and governance outcome quality. Figure \ref{fig:cor} shows the respective posterior distributions.

```{r cor, fig.align='center', fig.cap='Correlation among latent village characteristics as estimated from the item response model: (a) Posterior distribution of the correlation parameter with equal-tailed 90\\% credible interval; (b) Bivariate 90\\% posteriors for each village visualized as contours in the latent characteristic space.', out.width="100%"}
include_graphics("outputs/cor_itm_fit_irt_2par.png")
```

Posterior distributions for all remaining model parameters not yet shown in above figures are reported in Table \ref{tab:postpar}.

```{r postpar}
pars_tab %>% 
  kable(
    escape = FALSE,
     caption = "Summary of posterior distributions for further model parameters.",
    booktabs = TRUE,
    linesep = "",
    col.names =
      c("Parameter", "Mean", "SD", "P05", "Median", "P95"),
    align = c("l", rep("r", ncol(pars_tab) - 1))
  )%>%
  kable_styling(latex_options = "HOLD_position") %>%
  footnote(general = "'P' refers to percentile.")
```

It is apparent from the rather wide quantile-based intervals that uncertainty about the model parameters is generally high. It is a consequence of the small sample size of villages and the many parameters of the IRT model. Nevertheless, as discernible from Figure \ref{fig:cor}, we can be very certain about the positive relationship between quality of governance processes and governance outcomes on the village level as characterized by Ostrom's Diagnostic Framework variables.

The IRT nature of the model allows to extract some more insights. Figure \ref{fig:riestims} shows that items differ widely in their estimates for easiness $b_i$ (i.e., their tendency to yield high scores), which is in line with the between-item variation in response distributions already observed in the raw data (Table \ref{tab:dfsum}). We can also interpret the posterior distributions for the item-specific discrimination parameter $a_i$. If it is shifted to the right (as, e.g., for the item *GS7.3: External sanctions* in Figure \ref{fig:riestims}), then for this third-tier variable there is a steeper-than-average relationship between the underlying latent trait $\theta_j^{\text{Gov}}$ and the tendency to obtain high response scores in that item. This is equivalent with saying that the item is better able to discriminate between villages of very high and very low latent governance quality.^[Another way to look at it is that an item with higher values of $a_i$ has a lower latent standard deviation [@burkner_ordinal_2019]. The intuition is that an item that discriminates better produces less spread out response scores for one given value of the latent variable [see also @liddell_analyzing_2018, p. 331].]

The posteriors of the model parameters allow to construct so-called "item characteristic curves" (ICC) to better understand the relationship between the latent village traits and response probabilities for an item [@linden_handbook_1997]. The ICC of item $i$ results from the interplay of the item's values for $a_i$ and $b_i$. As a relevant example, Figure \ref{fig:icc} shows how the estimated IRT model relates the latent village trait $\theta_j^{\text{Out}}$, i.e., the unobserved quality of governance outcomes, to the propensity to choose an observable ordinal response category for the item *O1.1: Compliance*.

```{r icc, fig.align='center', fig.cap='Item characteristic curve for one item, as estimated in the ITR model. Expected probabilities for the three ordinal response options are shown (posterior median and 90\\% equal-tailed credible interval) in relation to the underlying latent village-level trait. Upper panel shows the posterior densities of the latent trait for all 12 study villages (same color coding as previously).', out.width="70%"}
include_graphics("outputs/icc_fit_irt_2par.png")
```

It is clear from Figure \ref{fig:icc} that based on the model we would expect most villages to give medium or high responses in the item *O1.1: Compliance*, which aligns well with observed and predicted frequencies for that same item shown in Figure \ref{fig:ppds}.

Importantly, what we have estimated here is merely the association of the quality of governance processes and outcomes, which cannot per se be interpreted as a causal effect of the former on the latter. There are at least two distinct threats to causal identification of the effect of governance processes on governance outcomes in our setting:

(i) There could be unobserved  (e.g., geographical, social, cultural, economic) factors which affect both quality of governance and of outcomes among villages in the Northern Tanzania Rangelands Initiative (NTRI) project (*confounding bias*).
(ii) We have only observed the relationship for the subset of villages which was non-randomly selected into the NTRI and, later, into the project assessment. Both quality of governance and outcomes could (directly or indirectly) affect the probability of being included in the assessment (*selection bias*).

The two types of influences are displayed in the causal directed acyclic graph (DAG) in Figure \ref{fig:dagbig}. The circled $U$ nodes are factors that are unobserved and (unlike the latent village traits $\theta_j^{\text{Gov}}$ and $\theta_j^{\text{Out}}$ we inferred above) cannot be proxied by any observed information. The squared box around a node indicates that our analysis is conditioning on that variable. Whereas $U_1$ creates confounding, the circled nodes $U_2$ and $U_3$, in conjunction with the square nodes, create selection bias [@hernan_causal_2020, chapter 8]. Note that such selection is built into the study design. Since the data only covers villages which were part of the NTRI project *and* which were assessed, the conditioning cannot be avoided. Under the presented causal structure, the conditioning due to selection could induce some spurious relationship (so-called "M-bias") between governance processes and outcomes.^[We have some information about the selection process. For the assessment and data collection, the project team selected villages following ideas of the case-oriented comparative method [@ragin_comparative_1987]. Bearing similarity to case-control designs, this involved collecting data both in villages that were believed to have achieved good governance outcomes over the project period as well as in somewhat similar villages that were believed to have achieved worse governance outcomes (with outcomes judged by remote sensing analysis). The intention is that this allows to find decisive features that explain differences in outcomes. However, such a design would not resolve the confounding and selection problems. In fact, it could create an additional causal path between outcomes and participation in the assessment besides the backdoor path through $U_3$ in the DAG in Figure \ref{fig:dagbig}, while it is still possible that some unobserved factors vary between villages and function like the nodes $U_1$ and $U_2$.]

```{r dagbig, fig.align='center', fig.cap='DAG to illustrate the potential confounding and selection bias affecting estimates of the effect of governance quality on governance outcomes. Circles indicate unobserved variables, square boxes indicate conditioned-on variables due to study design. The color indicates the two variables of interest. All variables are defined on the village level.', out.width="85%"}
include_graphics("outputs/dag1.png")
```

Note that Figure \ref{fig:dagbig} implies the plausible belief that participation of villages in the NTRI project (positively) affected their quality of commons governance. Still, estimating a causal effect of the NTRI project on quality of governance or outcomes is even more problematic in the present setting, because, by study design, there is no variation in treatment status (i.e., participation in NTRI) in the data. This is also why we do not show confounding between NTRI project participation and governance processes or outcomes in the DAG in Figure \ref{fig:dagbig}, even though it most likely exists. Any such backdoor path is not relevant to the analysis in this section, which is *not* an impact evaluation of the NTRI project.

Taking the DAG in Figure \ref{fig:dagbig} as a foundation, it is not possible to adjust for all factors that bias a causal estimate of the effect of quality of governance processes on governance outcomes as inferred from Ostrom's social-ecological system diagnostic variables.^[As a further threat to causality, reverse causation could (partially) be at work. All items were measured simultaneously in focus groups and interviews, such that perceived commons outcomes could have biased retrospective judgments about commons governance processes.] Consequently, we refrain from making such an attempt. Instead, we have focused in this section on arriving at an estimate of the statistical association between these two latent traits within an IRT framework and an honest representation of its uncertainty.

# Modeling remote sensing outcomes as a result of governance processes

This whole section is more or less completely drafted and open to discussion (e.g., what to add/leave out).

## Motivation

The analyzed outcome in the previous section was based on the synthesis from multiple qualitative data sources that elicited detailed perceptions and interpretations across different actor groups. Arguably, these provide rather accurate judgments of governance outcomes from local observers. These judgments are encoded by the scores in the DF variables of the first-tier category *Outcomes (O)*. As a potential downside, the response scores are "subjective" in the sense that they are self-reported. Therefore, as an alternative measure of commons outcomes, in this section we use remote sensing data of village grazing land areas. The outcome measure is area of bare ground and obtained from the MODIS Vegetation Continuous Fields data set with 250 m spatial resolution [@dimiceli_modisterra_2022]. The data contains annual estimates of tree cover, percent non-vegetated area. By averaging over the years 2010 to 2015 and 2016 to 2021, we obtain pre- and post-project estimates, respectively, of the area that is bare ground for each village (data shown in Figure \ref{fig:boxes}). The outcome of interest is defined as logarithm of the factor change in bare ground from pre- to post-period $d_{\text{bare}} = \text{log} \left( \text{bare}_{\text{post}} / \text{bare}_{\text{pre}} \right)$.^[Normalizing by pre-project bare ground is necessary due to the widely ranging baseline variation in bare ground share and/or total area across villages (the largest assessment village has more than 20 times the area of the smallest). Taking the ratio $\text{bare}_{\text{post}} / \text{bare}_{\text{pre}}$ implies the assumption that relative differences are of interest. For example, a village that halves a small amount of bare ground area (due to having small total area, or due to being densely vegetated, or both) will get the same value of $d_{\text{bare}}$ as a village that halves a huge amount of bare ground area (due to having large total area, or due to being only sparsely vegetated, or both). The logarithmic transformation ensures useful properties for Gaussian modeling, like a more symmetric and unbounded outcome distribution.]

Bare ground is an indicator for low quality of grazing land and the expansion of bare ground is a threat to local pastoralists [@mapinduzi_use_2003; @wiethase_pathways_2023]. Decrease in bare ground cover after the start of the NTRI project ($d_{\text{bare}} < 0$) is hence a suitable proxy variable to measure success in commons management in the present context. Yet, it is not without caveats. First, all potential confounding and selection biases explained in the previous section and laid out in Figure \ref{fig:dagbig} *can in the same way affect the relationship between governance and outcomes when using remote sensing data*. For simplicity, they are summarized in one single node $U_{123}$ in the DAG in Figure \ref{fig:dagbig2}. Thus, we need to keep in mind that also the remote sensing analysis cannot credibly establish a causal path from variation in governance quality to variation in commons outcomes. Yet, it allows to check if our previous result on the positive association of governance processes and outcomes still holds when using an alternative, external data source for commons outcomes. Second, bare ground cover is affected by other processes that should be accounted for when estimating the (conditional) association of quality of governance processes and commons outcome. A respective causal graph can guide analysis (Figure \ref{fig:dagbig2}).

```{r dagbig2, fig.align='center', fig.cap='DAG for the effect of governance quality on change in bare ground cover. Circles indicate unobserved variables. The color indicates the two variables of interest. All variables are defined on the village level.', out.width="85%"}
include_graphics("outputs/dag2.png")
```

<!-- # add to caption: The node \\$U_{123}\\$ summarizes the effect of nodes \\$U_{1}\\\$, \\\$U_{2}\\\$ and \\\$U_{3}\\\$ from Figure \ref{}.  -->

Figure \ref{fig:dagbig2} highlights that we expect the change in bare ground to be affected by, among others, two observed variables. On the one hand, vegetation cover is strongly influenced by rainfall in the Tanzanian savannah [@wiethase_pathways_2023]. On the other hand, invasive plant species, which are a major threat to grazing lands in the region [@wiethase_pathways_2023; @obiri_invasive_2011], can cover bare ground. Even though they lead to vegetated patches, as they tend to colonize bare ground quickly, they are often toxic or suppress the growth of palatable grasses. Hence, rangeland management aims to limit their spread. This is why an item on invasive species pressure was explicitly elicited from communities in our study as part of the *Outcomes (O)* category (Table \ref{tab:dfsum}). 

Consequently, both rainfall intensity and invasive species pressure *after the onset of the NTRI project* can be expected to exert major influences on the remote sensing-based estimate of bare ground change. At the same time, both variables could be associated via third variables with the propensity to establish good governance processes, for example due to differences in ecology or ethnic composition across villages (captured by nodes $U_4$ and $U_5$ in Figure \ref{fig:dagbig2}). Pressure by invasive species could even be a direct consequence of the quality of governance processes (see the arrow from $\theta^{\text{Gov}}$ to invasives in Figure \ref{fig:dagbig2}). Still, the problem with this mediator variable is that we expect it to *reduce* bare ground, but nevertheless make the common rangeland *less* suitable for grazing, indicating a *worse* commons outcome.

These considerations lead us to adjust the analysis of bare ground change for variables that capture extent of rainfall and of invasive species pressure during the years after the start of the NTRI project.^[Note that adding (plausible) paths from rainfall to governance or from rainfall to invasive species in Figure \ref{fig:dagbig2} would not affect this adjustment set.] The previous analysis (section XXX) of multidimensional outcomes based on detailed community responses (e.g., about compliance with rules) arguably did not require such adjustment. In contrast, remote sensing outcomes assess a more narrow picture of governance outcomes subject to strong idiosyncratic external forces like precipitation. Conditioning on these factors will help to eliminate some variation in outcomes that is not informative about the association of governance processes with governance outcomes (narrowly defined here as factor change in non-vegetated area), but certainly not all (see node $U_{123}$ in Figure \ref{fig:dagbig2}).

We rely on PERSIANN-CCS precipitation data [@nguyen_chrs_2019] and create a mean annual precipitation estimate for each village by averaging over the years 2016 to 2020 (data shown in Figure \ref{fig:boxes}). \textcolor{red}{As a coarse measure of prevalence of invasive species ... -> note that this must conceptually be a measure for prevalence/pressure FOR THE POST PERIOD, see explanations above. Since I model the CHANGE.}


## Formal model definition

\textcolor{red}{effect of governacne processes (effect not meaning cauasl, see previous) leading to:}

$$d_{\text{bare}_j} = \gamma_0 + \gamma_1 \text{Rainfall}_j + \gamma_2 \text{Invasives}_j + \gamma_3 \theta_j^{\text{Gov}} + \epsilon_j,$$

with $\epsilon_j \sim N(0, \sigma)$. The parameter $\theta_j^{\text{Gov}}$, however, is latent. However, we have obtained posterior distributions of $\theta_j^{\text{Gov}}$ for each village $j$ based on the IRT model in section XXX. Rather than treating the expected value of those distributions as fixed data, \textcolor{red}{the Bayesian modeling framework allows to ..}

measurement error notation

priors parameters notation

## Results

```{r postpar2}
pars_tab2 %>% 
  kable(
    escape = FALSE,
     caption = "xxx.",
    booktabs = TRUE,
    linesep = "",
    col.names =
      c("Parameter", "Mean", "SD", "P05", "Median", "P95"),
    align = c("l", rep("r", ncol(pars_tab) - 1))
  )%>%
  kable_styling(latex_options = "HOLD_position") %>%
  footnote(general = "'P' refers to percentile.")
```

two covariates held at median

```{r predbare, fig.align='center', fig.cap='xxx.', out.width="70%"}
include_graphics("outputs/pred_bareground.png")
```

<!-- - First acknowledge that previous outcomes measure is BETTER. And needs NO adjustment. -->

<!--     - Majory: "I think our measures may be stronger in that we have triangulated most if not all the variables that needed second opinion. It is easy for the village leaders or the grazing committee to report a positive outcome because of their authority or assigned responsibility. However, asking the same question among women's and men's focus groups gives us more reliable responses - remember that we took a score reported by most groups, not one." -->
<!--     - Monique: "I think majory has very strong point here. I know GIS outcomes are considered gold standard, but issues of interpretation are huge, as discussed above, and local perceptions are UNDOUBTEDLY the most accurate (and meaningful!). I'd be happy to argue this in print. Indeed we did in our BioScience paper on lion counting" -->

<!-- - ackboledge that bias from previous section cannot be killed, but extend the dag  -->

<!--     - to include the relationship modelled above in previous section. So there is one effect from GOV to outcome Remote Sensing, and one to outcome Item Responses -->

<!-- - confounding arrows for BOTH of these relationships, and explain that we will never be able to resolve these. -> but we can use the DAG to de-bias the second estimation from other influenes (e.g., invasices [Majory: " reduction in bare ground could be a result of increased invasives, since they tend to colonize bare ground fast."], agriculture), just not from the fundamental problem of endogeneity of treatment assignment (selection of program villages by outsiders + "selection" of governance quality by villagers) -->

<!-- - make sure that these are (mostly) mututally exclusive, which is an assumption I used and monique shares: "I assume maize wheat and bean fields dont look bare in a satelite image". We asked Nathaniel. Maybe we need to look into the polygon files. also see moniques references and paper sent via mail -->

<!-- - add to dag an edge from rainfall to governance: "I guess pastoralist (PA) institutions breakdown where rainfall makes agriculture and option, and possibly where rainfall makes outsiders beg for grazing." -->

<!-- - but majoy points that the high-rainfall villages are ethnically different: "I think the other issue we see here is the ethnic composition of villages with more rainfall (mainly two of them). The villages with more rainfall tend to be more agricultural but also occupied by more non-Maasai." And Monioque agrees that THIS is the reason probably: "interesting, and of cours right! it is th ethnic heterogeneity, not th rainfall, that is driving this result" -> such a thing should be implied by a confounding node between rainfall and governance. Good example of it. -->

<!-- - maybe extend dag: "The DAG starting page 20 on bare ground looks pretty good to me, but I think weâd need a zoom session with Majory and Susan where you explain it, as they are more likely to think of additional paths/variables than I am." -->

<!-- - Majory: Invasives kÃ¶nnen auch unter good governance gedeihen, v.a. als effekt von wenig rainfall: "One could also assume that invasives may have been increasing at a fast rate (as witnessed in some villages), colonizing bare areas, and thus reducing the bareground - this may happen even with good commons governance efforts, partly due to long droughts." -> additional arrow? -->
    
auch was zu agricutlural conversion???

- Majory agrees that good governacne implies negative effect on agricultural conversion: "I would expect conversion at a slower rate to imply better governance."

Agriculture threat BUT CROPLAND INDICATOR > POSITIVE CORRELATION WITH BAREGROUND PERCENT. Also ist beides ein indicator fÃ¼r schlechten boden. Brauche agriculture nicht im DAG.
...

For information on cropland cover, we rely on the global data set by @potapov_global_2022, who classified 30 m resolution Landsat satellite imagery into presence and absence of cropland. Their data set is split into epochs, two of which (2012â2015 and 2016â2019) well align with the periods before and after the start of the NTRI project. This allows to extract pre- and post-project estimates of cropland area separately for each village in the assessment (data shown in Figure \ref{fig:boxes}; in line with regional and global trends, cropland area increased over time in the studied villages).

# Modeling wealth outcomes as a result of governance processes

- wealth inequality from PCA as SD, for example @sharma_escalation_2023. But it REALLY strong correlation with mean/median Welath level from PCA (> 0.75). Just because the presence of rich people increases inequaluty and increases mean wealth. . . Could adjust for it, of course? Or acknowledge that we cannot separate it - but that is a bit shitty, because one is "good" (wealth) one is bad ("inequality") for villages ?!

- Majory is against wealth outcome idea: "I thought the wealth inequality (economic heterogeneity) variable needs to be looked at as a predictor and not an outcome. I think assessing it as an outcome shifts the focus from the DF, although it probably makes sense if we're assessing the impact of the NTRI initiative, which I believe is not the focus."

- "but I did think (again initially) it would be nice to have a measure of wealth (averaged across households) and inequality in wealth. I could think about this more if I wer to turn back to the original data, but now. But having wealth and inequality in wealth as an outcomes measure woud be kind of cool. I know its weak, as it is also something of a predictor variable f success (presumably), and without a longitudinal perspective inference is weak, but even with those prosvisos it might be worth including in the current modelling structure as a village level âoutcomeâ."

# Governance processes and outcomes under disturbances

- Majory daraufhin: "My interpretation was that he would look a the various reported external threats I shared in a Table. We also have two variables asked in the household survey, ethnic composition and economic activities, but have only one data point."

- "it would be good to look at interactins and/or mediations with disturbances, and I agree rainfall, ethnic/econ heterogeneity, and pop growth are all good candidates, if handled separately"

- "external threats could be added to the disturbance analysis discussed earlier â worth doing, even if only ends up in SM so we can say in the the MS that we examined disturbances."

we have:
"4.8.1.1 Rangeland threats: Drought
4.8.1.2 Rangeland threats: Diseases
4.8.1.3 Rangeland threats: Policy changes
4.8.1.4 Rangeland threats: Invasive sp
4.8.1.5 Rangeland threats: Floods
4.8.1.6 Rangeland threats: Land conflicts
4.8.1.7 Rangeland threats: Wildlife animals
4.8.1.8 Rangeland threats: High Hpop
4.8.1.9 Rangeland threats: Wildfires
4.8.2.1 Rangeland threats: Solution, environ awareness
4.8.2.2 Rangeland threats: Solution, rotational grazing
4.8.2.3 Rangeland threats: Solution, alternative rangeland
4.8.2.4 Rangeland threats: Solution, reduce # of livestock
4.8.2.5 Rangeland threats: Solution, enact rules
4.8.2.6 Rangeland threats: Solution, punish violators
4.8.2.7 Rangeland threats: Solution, restrict wildlife
4.8.3.1 Rangeland threats: Leadership challenge (lack of leader trust)
4.8.3.2 Rangeland threats: Leadership challenge (Insects)
4.8.3.3 Rangeland threats: Leadership challenge (Lack of cooperation)
4.8.3.4 Rangeland threats: Leadership challenge (water shortage)
4.8.4.1 Rangeland threats: Leadership opportunity (training)
4.8.4.2 Rangeland threats: Leadership opportunity (take part in decision)"
Analytical question: Please name and describe the major threats that are affecting this rangeland. A threat is a process/event that has the potential to severely damage an important function of a system. The governance activities within a social-ecological system can be undermined by threats and disturbances that occur. Source of data: Men and women FGD, VLG, Grazing related committees.


- rainfall variability can also be used: "Pastoralist scholars are oftn mre concerned about rainfall unpredictabiilty and variability than mean amount, but under the current circumstances of increasing drought, this measure may be fine for us. I will keep my eyes open for how rainfall is being used in recent paper"

- there is a hypothesis why rainfall might cause worse pastoralist governacne processes and outcomes: "I guess pastoralist (PA) institutions breakdown where rainfall makes agriculture and option, and possibly where rainfall makes outsiders beg for grazing." and it could lead to discussion like: "'Is agriculture a feasible livelihood option?'. It might lead on from the finding (prelim pr page 12 descriptive analysis) that rainfall has neg effects on governance, on the logic that if PA institutions suffer in wetter areas, what is the logic for mving to agric. [Very politically un PC, but possibly worth investigating for the area]."

- Majory thinks that disturances are quantified by a delta, not by a level: "I think to stay within the framework, you have to look at the changes in demographics rather than its absolute composition. However, I also see that with the exception of population growth which we have as a continuous variable for pre and post, I'm not sure if we can rely on qualitative values of changes in ethnic composition and economic activities. I can see why it would make sense to look at how the absolute composition of the two contributes to governance and outcomes directly, and we can document the modifications. I also think this is where you could use survey data because they provide absolute responses which can even be weighted."

# Comparing remote sensing outcomes with a control group

- "might require some sort of âsynthetic counterfactualâ. Quite how we deal with the fact that NTRI presumably selected the villages for intervention on the basis of some criteria will take some thought. Initially Susan or Majory could help us here. I am not sure that our 12 villages comprise the full set of NTRI targets â this would help us enormously with developing controls for GIS."

- Majory against this: "I wonder if its useful to address whether NTRI was a success considering this would be based solely on GIS data. I don't think we have to for this analysis, just a thought."

- Monique: "Success/not success - a difficult decision to call. i think we keep OFF direct evaluation of their intervention, indeed they never provided us enough detail of what they did where."

- Majory on village selection for assessment: "During study design is when we decided it was first necessary to have at least an equal number of villages considered as "successful" and "not successful" purely based on GIS analysis performed by Colin and not whether the group was a treated or control. "

# References



